{% extends 'base.html' %}

{% block content %}

<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Dashboard</h2>
    <div>
      <a href="{% url 'vehiculo_list' %}" class="btn btn-outline-light btn-sm me-2">
        <i class="bi bi-truck-front me-1"></i> Ver veh铆culos
      </a>
      <a href="{% url 'documento_list' %}" class="btn btn-outline-light btn-sm">
        <i class="bi bi-files me-1"></i> Ver documentos
      </a>
    </div>
  </div>

  <!-- Tarjetas resumen -->
  <div class="row g-4 mb-4">
    <div class="col-md-4">
      <div class="card card-dashboard h-100">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-uppercase mb-1 text-muted">Veh铆culos activos</h6>
            <div class="fs-2 fw-bold">{{ total_vehiculos }}</div>
          </div>
          <i class="bi bi-truck-front" style="font-size: 2.5rem;"></i>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card card-dashboard-warning h-100">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-uppercase mb-1 text-muted">Pr贸ximos a vencer (30 d铆as)</h6>
            <div class="fs-2 fw-bold">{{ proximos|length }}</div>
          </div>
          <i class="bi bi-exclamation-triangle" style="font-size: 2.5rem;"></i>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card card-dashboard-danger h-100">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h6 class="text-uppercase mb-1 text-muted">Vencidos</h6>
            <div class="fs-2 fw-bold">{{ vencidos|length }}</div>
          </div>
          <i class="bi bi-x-octagon" style="font-size: 2.5rem;"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Listas de documentos -->
  <div class="row g-4">
    <!-- Pr贸ximos a vencer -->
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <i class="bi bi-hourglass-split me-2"></i>
            <span>Documentos pr贸ximos a vencer</span>
          </div>
          <a href="{% url 'documento_list' %}?estado=proximos" class="btn btn-sm btn-outline-light">
            Ver todos
          </a>
        </div>
        <div class="card-body p-0">
          <ul class="list-group list-group-flush">
            {% for doc in proximos %}
              <li class="list-group-item bg-transparent text-light d-flex justify-content-between align-items-center">
                <div>
                  <strong>{{ doc.vehiculo.placa }}</strong> 路 {{ doc.tipo.nombre }}<br>
                  <small class="text-muted">
                    Vence: {{ doc.fecha_vencimiento }}
                    {% if doc.vehiculo.responsable_nombre %}
                      路 Responsable: {{ doc.vehiculo.responsable_nombre }}
                    {% endif %}
                  </small>
                </div>
                <a href="{% url 'vehiculo_detail' doc.vehiculo.pk %}" class="btn btn-sm btn-outline-light">
                  Ver veh铆culo
                </a>
              </li>
            {% empty %}
              <li class="list-group-item bg-transparent text-light">
                No hay documentos pr贸ximos a vencer 
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Vencidos -->
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <i class="bi bi-x-circle me-2"></i>
            <span>Documentos vencidos</span>
          </div>
          <a href="{% url 'documento_list' %}?estado=vencidos" class="btn btn-sm btn-outline-light">
            Ver todos
          </a>
        </div>
        <div class="card-body p-0">
          <ul class="list-group list-group-flush">
            {% for doc in vencidos %}
              <li class="list-group-item bg-transparent text-light d-flex justify-content-between align-items-center">
                <div>
                  <strong>{{ doc.vehiculo.placa }}</strong> 路 {{ doc.tipo.nombre }}<br>
                  <small class="text-muted">
                    Venci贸: {{ doc.fecha_vencimiento }}
                    {% if doc.vehiculo.responsable_nombre %}
                      路 Responsable: {{ doc.vehiculo.responsable_nombre }}
                    {% endif %}
                  </small>
                </div>
                <a href="{% url 'vehiculo_detail' doc.vehiculo.pk %}" class="btn btn-sm btn-outline-light">
                  Ver veh铆culo
                </a>
              </li>
            {% empty %}
              <li class="list-group-item bg-transparent text-light">
                No hay documentos vencidos 
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>

</div>

{% endblock %}
